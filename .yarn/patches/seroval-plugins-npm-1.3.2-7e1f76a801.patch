diff --git a/dist/cjs/development/web.cjs b/dist/cjs/development/web.cjs
index 2aa712dd44944942ac180ca2e169b2d11b0083ea..0e9f6762696293c627de3abddb026e132beaa0f8 100644
--- a/dist/cjs/development/web.cjs
+++ b/dist/cjs/development/web.cjs
@@ -593,7 +593,7 @@ var ReadableStreamFactoryPlugin = /* @__PURE__ */ (0, import_seroval10.createPlu
       ["d"],
       "new ReadableStream({start:" + ctx.createEffectfulFunction(
         ["c"],
-        "d.on({next:" + ctx.createEffectfulFunction(["v"], "c.enqueue(v)") + ",throw:" + ctx.createEffectfulFunction(["v"], "c.error(v)") + ",return:" + ctx.createEffectfulFunction([], "c.close()") + "})"
+        "d.on({next:" + ctx.createEffectfulFunction(["v"], "c.enqueue(v)") + ",throw:" + ctx.createEffectfulFunction(["v"], "c.error(v)") + ",return:" + ctx.createEffectfulFunction([], "try{c.close()}catch{}") + "})"
       ) + "})"
     );
   },
@@ -665,7 +665,9 @@ var ReadableStreamPlugin = /* @__PURE__ */ (0, import_seroval10.createPlugin)({
             controller.error(value);
           },
           return() {
-            controller.close();
+            try {
+              controller.close();
+            } catch {}
           }
         });
       }
diff --git a/dist/cjs/production/web.cjs b/dist/cjs/production/web.cjs
index 1d3b95c1235591fc479424edb5f19dea704cb0b8..e5bf7b11a0eaffb7d69e5f9444506ae8c345ffd2 100644
--- a/dist/cjs/production/web.cjs
+++ b/dist/cjs/production/web.cjs
@@ -1 +1 @@
-"use strict";var c=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var X=(e,r)=>{for(var a in r)c(e,a,{get:r[a],enumerable:!0})},Z=(e,r,a,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of K(r))!Q.call(e,n)&&n!==a&&c(e,n,{get:()=>r[n],enumerable:!(t=J(r,n))||t.enumerable});return e};var $=e=>Z(c({},"__esModule",{value:!0}),e);var ze={};X(ze,{AbortSignalPlugin:()=>v,BlobPlugin:()=>N,CustomEventPlugin:()=>h,DOMExceptionPlugin:()=>E,EventPlugin:()=>D,FilePlugin:()=>m,FormDataPlugin:()=>C,HeadersPlugin:()=>o,ImageDataPlugin:()=>O,ReadableStreamPlugin:()=>i,RequestPlugin:()=>M,ResponsePlugin:()=>k,URLPlugin:()=>Y,URLSearchParamsPlugin:()=>W});module.exports=$(ze);var f=require("seroval");function x(e){e(this.reason)}function ee(e){this.addEventListener("abort",x.bind(this,e),{once:!0})}function re(e){return new Promise(ee.bind(e))}var l=class{constructor(){this.controller=new AbortController}},ae=(0,f.createPlugin)({tag:"seroval-plugins/web/AbortSignalController",test(e){return e instanceof l},parse:{stream(){}},serialize(e){return"new AbortController"},deserialize(e){return new l}}),p=class{constructor(r,a){this.controller=r;this.reason=a}},te=(0,f.createPlugin)({extends:[ae],tag:"seroval-plugins/web/AbortSignalAbort",test(e){return e instanceof p},parse:{stream(e,r){return{controller:r.parse(e.controller),reason:r.parse(e.reason)}}},serialize(e,r){return r.serialize(e.controller)+".abort("+r.serialize(e.reason)+")"},deserialize(e,r){let a=r.deserialize(e.controller),t=r.deserialize(e.reason);return a.controller.abort(t),new p(a,t)}});var ne=(0,f.createPlugin)({tag:"seroval-plugins/web/AbortSignal",extends:[te],test(e){return typeof AbortSignal=="undefined"?!1:e instanceof AbortSignal},parse:{sync(e,r){return e.aborted?{type:1,reason:r.parse(e.reason)}:{type:0}},async async(e,r){if(e.aborted)return{type:1,reason:await r.parse(e.reason)};let a=await re(e);return{type:1,reason:await r.parse(a)}},stream(e,r){if(e.aborted)return{type:1,reason:r.parse(e.reason)};let a=new l;return r.pushPendingState(),e.addEventListener("abort",()=>{let t=r.parseWithError(new p(a,e.reason));t&&r.onParse(t),r.popPendingState()},{once:!0}),{type:2,controller:r.parse(a)}}},serialize(e,r){return e.type===0?"(new AbortController).signal":e.type===1?"AbortSignal.abort("+r.serialize(e.reason)+")":"("+r.serialize(e.controller)+").signal"},deserialize(e,r){return e.type===0?new AbortController().signal:e.type===1?AbortSignal.abort(r.deserialize(e.reason)):r.deserialize(e.controller).controller.signal}}),v=ne;var P=require("seroval"),oe=(0,P.createPlugin)({tag:"seroval-plugins/web/Blob",test(e){return typeof Blob=="undefined"?!1:e instanceof Blob},parse:{async async(e,r){return{type:await r.parse(e.type),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new Blob(["+r.serialize(e.buffer)+"],{type:"+r.serialize(e.type)+"})"},deserialize(e,r){return new Blob([r.deserialize(e.buffer)],{type:r.deserialize(e.type)})}}),N=oe;var R=require("seroval");function g(e){return{detail:e.detail,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var se=(0,R.createPlugin)({tag:"seroval-plugins/web/CustomEvent",test(e){return typeof CustomEvent=="undefined"?!1:e instanceof CustomEvent},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(g(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(g(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(g(e))}}},serialize(e,r){return"new CustomEvent("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new CustomEvent(r.deserialize(e.type),r.deserialize(e.options))}}),h=se;var A=require("seroval"),ie=(0,A.createPlugin)({tag:"seroval-plugins/web/DOMException",test(e){return typeof DOMException=="undefined"?!1:e instanceof DOMException},parse:{sync(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}},async async(e,r){return{name:await r.parse(e.name),message:await r.parse(e.message)}},stream(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}}},serialize(e,r){return"new DOMException("+r.serialize(e.message)+","+r.serialize(e.name)+")"},deserialize(e,r){return new DOMException(r.deserialize(e.message),r.deserialize(e.name))}}),E=ie;var F=require("seroval");function y(e){return{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var le=(0,F.createPlugin)({tag:"seroval-plugins/web/Event",test(e){return typeof Event=="undefined"?!1:e instanceof Event},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(y(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(y(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(y(e))}}},serialize(e,r){return"new Event("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Event(r.deserialize(e.type),r.deserialize(e.options))}}),D=le;var I=require("seroval"),pe=(0,I.createPlugin)({tag:"seroval-plugins/web/File",test(e){return typeof File=="undefined"?!1:e instanceof File},parse:{async async(e,r){return{name:await r.parse(e.name),options:await r.parse({type:e.type,lastModified:e.lastModified}),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new File(["+r.serialize(e.buffer)+"],"+r.serialize(e.name)+","+r.serialize(e.options)+")"},deserialize(e,r){return new File([r.deserialize(e.buffer)],r.deserialize(e.name),r.deserialize(e.options))}}),m=pe;var S=require("seroval");function b(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var u={},ue=(0,S.createPlugin)({tag:"seroval-plugins/web/FormDataFactory",test(e){return e===u},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return u}}),de=(0,S.createPlugin)({tag:"seroval-plugins/web/FormData",extends:[m,ue],test(e){return typeof FormData=="undefined"?!1:e instanceof FormData},parse:{sync(e,r){return{factory:r.parse(u),entries:r.parse(b(e))}},async async(e,r){return{factory:await r.parse(u),entries:await r.parse(b(e))}},stream(e,r){return{factory:r.parse(u),entries:r.parse(b(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.entries)+")"},deserialize(e,r){let a=new FormData,t=r.deserialize(e.entries);for(let n=0,G=t.length;n<G;n++){let z=t[n];a.append(z[0],z[1])}return a}}),C=de;var B=require("seroval");function w(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var fe=(0,B.createPlugin)({tag:"seroval-plugins/web/Headers",test(e){return typeof Headers=="undefined"?!1:e instanceof Headers},parse:{sync(e,r){return r.parse(w(e))},async async(e,r){return await r.parse(w(e))},stream(e,r){return r.parse(w(e))}},serialize(e,r){return"new Headers("+r.serialize(e)+")"},deserialize(e,r){return new Headers(r.deserialize(e))}}),o=fe;var L=require("seroval"),me=(0,L.createPlugin)({tag:"seroval-plugins/web/ImageData",test(e){return typeof ImageData=="undefined"?!1:e instanceof ImageData},parse:{sync(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}},async async(e,r){return{data:await r.parse(e.data),width:await r.parse(e.width),height:await r.parse(e.height),options:await r.parse({colorSpace:e.colorSpace})}},stream(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}}},serialize(e,r){return"new ImageData("+r.serialize(e.data)+","+r.serialize(e.width)+","+r.serialize(e.height)+","+r.serialize(e.options)+")"},deserialize(e,r){return new ImageData(r.deserialize(e.data),r.deserialize(e.width),r.deserialize(e.height),r.deserialize(e.options))}}),O=me;var s=require("seroval"),d={},ce=(0,s.createPlugin)({tag:"seroval-plugins/web/ReadableStreamFactory",test(e){return e===d},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createFunction(["d"],"new ReadableStream({start:"+r.createEffectfulFunction(["c"],"d.on({next:"+r.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+r.createEffectfulFunction(["v"],"c.error(v)")+",return:"+r.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return d}});function U(e){let r=(0,s.createStream)(),a=e.getReader();async function t(){try{let n=await a.read();n.done?r.return(n.value):(r.next(n.value),await t())}catch(n){r.throw(n)}}return t().catch(()=>{}),r}var ge=(0,s.createPlugin)({tag:"seroval/plugins/web/ReadableStream",extends:[ce],test(e){return typeof ReadableStream=="undefined"?!1:e instanceof ReadableStream},parse:{sync(e,r){return{factory:r.parse(d),stream:r.parse((0,s.createStream)())}},async async(e,r){return{factory:await r.parse(d),stream:await r.parse(U(e))}},stream(e,r){return{factory:r.parse(d),stream:r.parse(U(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.stream)+")"},deserialize(e,r){let a=r.deserialize(e.stream);return new ReadableStream({start(t){a.on({next(n){t.enqueue(n)},throw(n){t.error(n)},return(){t.close()}})}})}}),i=ge;var H=require("seroval");function q(e,r){return{body:r,cache:e.cache,credentials:e.credentials,headers:e.headers,integrity:e.integrity,keepalive:e.keepalive,method:e.method,mode:e.mode,redirect:e.redirect,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}var ye=(0,H.createPlugin)({tag:"seroval-plugins/web/Request",extends:[i,o],test(e){return typeof Request=="undefined"?!1:e instanceof Request},parse:{async async(e,r){return{url:await r.parse(e.url),options:await r.parse(q(e,e.body?await e.clone().arrayBuffer():null))}},stream(e,r){return{url:r.parse(e.url),options:r.parse(q(e,e.clone().body))}}},serialize(e,r){return"new Request("+r.serialize(e.url)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Request(r.deserialize(e.url),r.deserialize(e.options))}}),M=ye;var _=require("seroval");function T(e){return{headers:e.headers,status:e.status,statusText:e.statusText}}var be=(0,_.createPlugin)({tag:"seroval-plugins/web/Response",extends:[i,o],test(e){return typeof Response=="undefined"?!1:e instanceof Response},parse:{async async(e,r){return{body:await r.parse(e.body?await e.clone().arrayBuffer():null),options:await r.parse(T(e))}},stream(e,r){return{body:r.parse(e.clone().body),options:r.parse(T(e))}}},serialize(e,r){return"new Response("+r.serialize(e.body)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Response(r.deserialize(e.body),r.deserialize(e.options))}}),k=be;var j=require("seroval"),Se=(0,j.createPlugin)({tag:"seroval-plugins/web/URL",test(e){return typeof URL=="undefined"?!1:e instanceof URL},parse:{sync(e,r){return r.parse(e.href)},async async(e,r){return await r.parse(e.href)},stream(e,r){return r.parse(e.href)}},serialize(e,r){return"new URL("+r.serialize(e)+")"},deserialize(e,r){return new URL(r.deserialize(e))}}),Y=Se;var V=require("seroval"),we=(0,V.createPlugin)({tag:"seroval-plugins/web/URLSearchParams",test(e){return typeof URLSearchParams=="undefined"?!1:e instanceof URLSearchParams},parse:{sync(e,r){return r.parse(e.toString())},async async(e,r){return await r.parse(e.toString())},stream(e,r){return r.parse(e.toString())}},serialize(e,r){return"new URLSearchParams("+r.serialize(e)+")"},deserialize(e,r){return new URLSearchParams(r.deserialize(e))}}),W=we;
+"use strict";var c=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var X=(e,r)=>{for(var a in r)c(e,a,{get:r[a],enumerable:!0})},Z=(e,r,a,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of K(r))!Q.call(e,n)&&n!==a&&c(e,n,{get:()=>r[n],enumerable:!(t=J(r,n))||t.enumerable});return e};var $=e=>Z(c({},"__esModule",{value:!0}),e);var ze={};X(ze,{AbortSignalPlugin:()=>v,BlobPlugin:()=>N,CustomEventPlugin:()=>h,DOMExceptionPlugin:()=>E,EventPlugin:()=>D,FilePlugin:()=>m,FormDataPlugin:()=>C,HeadersPlugin:()=>o,ImageDataPlugin:()=>O,ReadableStreamPlugin:()=>i,RequestPlugin:()=>M,ResponsePlugin:()=>k,URLPlugin:()=>Y,URLSearchParamsPlugin:()=>W});module.exports=$(ze);var f=require("seroval");function x(e){e(this.reason)}function ee(e){this.addEventListener("abort",x.bind(this,e),{once:!0})}function re(e){return new Promise(ee.bind(e))}var l=class{constructor(){this.controller=new AbortController}},ae=(0,f.createPlugin)({tag:"seroval-plugins/web/AbortSignalController",test(e){return e instanceof l},parse:{stream(){}},serialize(e){return"new AbortController"},deserialize(e){return new l}}),p=class{constructor(r,a){this.controller=r;this.reason=a}},te=(0,f.createPlugin)({extends:[ae],tag:"seroval-plugins/web/AbortSignalAbort",test(e){return e instanceof p},parse:{stream(e,r){return{controller:r.parse(e.controller),reason:r.parse(e.reason)}}},serialize(e,r){return r.serialize(e.controller)+".abort("+r.serialize(e.reason)+")"},deserialize(e,r){let a=r.deserialize(e.controller),t=r.deserialize(e.reason);return a.controller.abort(t),new p(a,t)}});var ne=(0,f.createPlugin)({tag:"seroval-plugins/web/AbortSignal",extends:[te],test(e){return typeof AbortSignal=="undefined"?!1:e instanceof AbortSignal},parse:{sync(e,r){return e.aborted?{type:1,reason:r.parse(e.reason)}:{type:0}},async async(e,r){if(e.aborted)return{type:1,reason:await r.parse(e.reason)};let a=await re(e);return{type:1,reason:await r.parse(a)}},stream(e,r){if(e.aborted)return{type:1,reason:r.parse(e.reason)};let a=new l;return r.pushPendingState(),e.addEventListener("abort",()=>{let t=r.parseWithError(new p(a,e.reason));t&&r.onParse(t),r.popPendingState()},{once:!0}),{type:2,controller:r.parse(a)}}},serialize(e,r){return e.type===0?"(new AbortController).signal":e.type===1?"AbortSignal.abort("+r.serialize(e.reason)+")":"("+r.serialize(e.controller)+").signal"},deserialize(e,r){return e.type===0?new AbortController().signal:e.type===1?AbortSignal.abort(r.deserialize(e.reason)):r.deserialize(e.controller).controller.signal}}),v=ne;var P=require("seroval"),oe=(0,P.createPlugin)({tag:"seroval-plugins/web/Blob",test(e){return typeof Blob=="undefined"?!1:e instanceof Blob},parse:{async async(e,r){return{type:await r.parse(e.type),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new Blob(["+r.serialize(e.buffer)+"],{type:"+r.serialize(e.type)+"})"},deserialize(e,r){return new Blob([r.deserialize(e.buffer)],{type:r.deserialize(e.type)})}}),N=oe;var R=require("seroval");function g(e){return{detail:e.detail,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var se=(0,R.createPlugin)({tag:"seroval-plugins/web/CustomEvent",test(e){return typeof CustomEvent=="undefined"?!1:e instanceof CustomEvent},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(g(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(g(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(g(e))}}},serialize(e,r){return"new CustomEvent("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new CustomEvent(r.deserialize(e.type),r.deserialize(e.options))}}),h=se;var A=require("seroval"),ie=(0,A.createPlugin)({tag:"seroval-plugins/web/DOMException",test(e){return typeof DOMException=="undefined"?!1:e instanceof DOMException},parse:{sync(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}},async async(e,r){return{name:await r.parse(e.name),message:await r.parse(e.message)}},stream(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}}},serialize(e,r){return"new DOMException("+r.serialize(e.message)+","+r.serialize(e.name)+")"},deserialize(e,r){return new DOMException(r.deserialize(e.message),r.deserialize(e.name))}}),E=ie;var F=require("seroval");function y(e){return{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var le=(0,F.createPlugin)({tag:"seroval-plugins/web/Event",test(e){return typeof Event=="undefined"?!1:e instanceof Event},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(y(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(y(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(y(e))}}},serialize(e,r){return"new Event("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Event(r.deserialize(e.type),r.deserialize(e.options))}}),D=le;var I=require("seroval"),pe=(0,I.createPlugin)({tag:"seroval-plugins/web/File",test(e){return typeof File=="undefined"?!1:e instanceof File},parse:{async async(e,r){return{name:await r.parse(e.name),options:await r.parse({type:e.type,lastModified:e.lastModified}),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new File(["+r.serialize(e.buffer)+"],"+r.serialize(e.name)+","+r.serialize(e.options)+")"},deserialize(e,r){return new File([r.deserialize(e.buffer)],r.deserialize(e.name),r.deserialize(e.options))}}),m=pe;var S=require("seroval");function b(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var u={},ue=(0,S.createPlugin)({tag:"seroval-plugins/web/FormDataFactory",test(e){return e===u},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return u}}),de=(0,S.createPlugin)({tag:"seroval-plugins/web/FormData",extends:[m,ue],test(e){return typeof FormData=="undefined"?!1:e instanceof FormData},parse:{sync(e,r){return{factory:r.parse(u),entries:r.parse(b(e))}},async async(e,r){return{factory:await r.parse(u),entries:await r.parse(b(e))}},stream(e,r){return{factory:r.parse(u),entries:r.parse(b(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.entries)+")"},deserialize(e,r){let a=new FormData,t=r.deserialize(e.entries);for(let n=0,G=t.length;n<G;n++){let z=t[n];a.append(z[0],z[1])}return a}}),C=de;var B=require("seroval");function w(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var fe=(0,B.createPlugin)({tag:"seroval-plugins/web/Headers",test(e){return typeof Headers=="undefined"?!1:e instanceof Headers},parse:{sync(e,r){return r.parse(w(e))},async async(e,r){return await r.parse(w(e))},stream(e,r){return r.parse(w(e))}},serialize(e,r){return"new Headers("+r.serialize(e)+")"},deserialize(e,r){return new Headers(r.deserialize(e))}}),o=fe;var L=require("seroval"),me=(0,L.createPlugin)({tag:"seroval-plugins/web/ImageData",test(e){return typeof ImageData=="undefined"?!1:e instanceof ImageData},parse:{sync(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}},async async(e,r){return{data:await r.parse(e.data),width:await r.parse(e.width),height:await r.parse(e.height),options:await r.parse({colorSpace:e.colorSpace})}},stream(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}}},serialize(e,r){return"new ImageData("+r.serialize(e.data)+","+r.serialize(e.width)+","+r.serialize(e.height)+","+r.serialize(e.options)+")"},deserialize(e,r){return new ImageData(r.deserialize(e.data),r.deserialize(e.width),r.deserialize(e.height),r.deserialize(e.options))}}),O=me;var s=require("seroval"),d={},ce=(0,s.createPlugin)({tag:"seroval-plugins/web/ReadableStreamFactory",test(e){return e===d},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createFunction(["d"],"new ReadableStream({start:"+r.createEffectfulFunction(["c"],"d.on({next:"+r.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+r.createEffectfulFunction(["v"],"c.error(v)")+",return:"+r.createEffectfulFunction([],"try{c.close()}catch{}")+"})")+"})")},deserialize(){return d}});function U(e){let r=(0,s.createStream)(),a=e.getReader();async function t(){try{let n=await a.read();n.done?r.return(n.value):(r.next(n.value),await t())}catch(n){r.throw(n)}}return t().catch(()=>{}),r}var ge=(0,s.createPlugin)({tag:"seroval/plugins/web/ReadableStream",extends:[ce],test(e){return typeof ReadableStream=="undefined"?!1:e instanceof ReadableStream},parse:{sync(e,r){return{factory:r.parse(d),stream:r.parse((0,s.createStream)())}},async async(e,r){return{factory:await r.parse(d),stream:await r.parse(U(e))}},stream(e,r){return{factory:r.parse(d),stream:r.parse(U(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.stream)+")"},deserialize(e,r){let a=r.deserialize(e.stream);return new ReadableStream({start(t){a.on({next(n){t.enqueue(n)},throw(n){t.error(n)},return(){try{t.close()}catch{}}})}})}}),i=ge;var H=require("seroval");function q(e,r){return{body:r,cache:e.cache,credentials:e.credentials,headers:e.headers,integrity:e.integrity,keepalive:e.keepalive,method:e.method,mode:e.mode,redirect:e.redirect,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}var ye=(0,H.createPlugin)({tag:"seroval-plugins/web/Request",extends:[i,o],test(e){return typeof Request=="undefined"?!1:e instanceof Request},parse:{async async(e,r){return{url:await r.parse(e.url),options:await r.parse(q(e,e.body?await e.clone().arrayBuffer():null))}},stream(e,r){return{url:r.parse(e.url),options:r.parse(q(e,e.clone().body))}}},serialize(e,r){return"new Request("+r.serialize(e.url)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Request(r.deserialize(e.url),r.deserialize(e.options))}}),M=ye;var _=require("seroval");function T(e){return{headers:e.headers,status:e.status,statusText:e.statusText}}var be=(0,_.createPlugin)({tag:"seroval-plugins/web/Response",extends:[i,o],test(e){return typeof Response=="undefined"?!1:e instanceof Response},parse:{async async(e,r){return{body:await r.parse(e.body?await e.clone().arrayBuffer():null),options:await r.parse(T(e))}},stream(e,r){return{body:r.parse(e.clone().body),options:r.parse(T(e))}}},serialize(e,r){return"new Response("+r.serialize(e.body)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Response(r.deserialize(e.body),r.deserialize(e.options))}}),k=be;var j=require("seroval"),Se=(0,j.createPlugin)({tag:"seroval-plugins/web/URL",test(e){return typeof URL=="undefined"?!1:e instanceof URL},parse:{sync(e,r){return r.parse(e.href)},async async(e,r){return await r.parse(e.href)},stream(e,r){return r.parse(e.href)}},serialize(e,r){return"new URL("+r.serialize(e)+")"},deserialize(e,r){return new URL(r.deserialize(e))}}),Y=Se;var V=require("seroval"),we=(0,V.createPlugin)({tag:"seroval-plugins/web/URLSearchParams",test(e){return typeof URLSearchParams=="undefined"?!1:e instanceof URLSearchParams},parse:{sync(e,r){return r.parse(e.toString())},async async(e,r){return await r.parse(e.toString())},stream(e,r){return r.parse(e.toString())}},serialize(e,r){return"new URLSearchParams("+r.serialize(e)+")"},deserialize(e,r){return new URLSearchParams(r.deserialize(e))}}),W=we;
diff --git a/dist/esm/development/web.mjs b/dist/esm/development/web.mjs
index 4df6a9482f749b99d317759ae8dd22911129be3b..6535dad4c7d5bbe5439740456a82ae1820cb5ef2 100644
--- a/dist/esm/development/web.mjs
+++ b/dist/esm/development/web.mjs
@@ -554,7 +554,7 @@ var ReadableStreamFactoryPlugin = /* @__PURE__ */ createPlugin10({
       ["d"],
       "new ReadableStream({start:" + ctx.createEffectfulFunction(
         ["c"],
-        "d.on({next:" + ctx.createEffectfulFunction(["v"], "c.enqueue(v)") + ",throw:" + ctx.createEffectfulFunction(["v"], "c.error(v)") + ",return:" + ctx.createEffectfulFunction([], "c.close()") + "})"
+        "d.on({next:" + ctx.createEffectfulFunction(["v"], "c.enqueue(v)") + ",throw:" + ctx.createEffectfulFunction(["v"], "c.error(v)") + ",return:" + ctx.createEffectfulFunction([], "try{c.close()}catch{}") + "})"
       ) + "})"
     );
   },
diff --git a/dist/esm/production/web.mjs b/dist/esm/production/web.mjs
index a0b42a10c8fe527b36e37ec351be2fc763b06e70..ee83c0ca4df02457cf5913ece76f8b2eb8c01572 100644
--- a/dist/esm/production/web.mjs
+++ b/dist/esm/production/web.mjs
@@ -1 +1 @@
-import{createPlugin as d}from"seroval";function h(e){e(this.reason)}function A(e){this.addEventListener("abort",h.bind(this,e),{once:!0})}function E(e){return new Promise(A.bind(e))}var o=class{constructor(){this.controller=new AbortController}},F=d({tag:"seroval-plugins/web/AbortSignalController",test(e){return e instanceof o},parse:{stream(){}},serialize(e){return"new AbortController"},deserialize(e){return new o}}),s=class{constructor(r,a){this.controller=r;this.reason=a}},D=d({extends:[F],tag:"seroval-plugins/web/AbortSignalAbort",test(e){return e instanceof s},parse:{stream(e,r){return{controller:r.parse(e.controller),reason:r.parse(e.reason)}}},serialize(e,r){return r.serialize(e.controller)+".abort("+r.serialize(e.reason)+")"},deserialize(e,r){let a=r.deserialize(e.controller),t=r.deserialize(e.reason);return a.controller.abort(t),new s(a,t)}});var I=d({tag:"seroval-plugins/web/AbortSignal",extends:[D],test(e){return typeof AbortSignal=="undefined"?!1:e instanceof AbortSignal},parse:{sync(e,r){return e.aborted?{type:1,reason:r.parse(e.reason)}:{type:0}},async async(e,r){if(e.aborted)return{type:1,reason:await r.parse(e.reason)};let a=await E(e);return{type:1,reason:await r.parse(a)}},stream(e,r){if(e.aborted)return{type:1,reason:r.parse(e.reason)};let a=new o;return r.pushPendingState(),e.addEventListener("abort",()=>{let t=r.parseWithError(new s(a,e.reason));t&&r.onParse(t),r.popPendingState()},{once:!0}),{type:2,controller:r.parse(a)}}},serialize(e,r){return e.type===0?"(new AbortController).signal":e.type===1?"AbortSignal.abort("+r.serialize(e.reason)+")":"("+r.serialize(e.controller)+").signal"},deserialize(e,r){return e.type===0?new AbortController().signal:e.type===1?AbortSignal.abort(r.deserialize(e.reason)):r.deserialize(e.controller).controller.signal}}),C=I;import{createPlugin as B}from"seroval";var L=B({tag:"seroval-plugins/web/Blob",test(e){return typeof Blob=="undefined"?!1:e instanceof Blob},parse:{async async(e,r){return{type:await r.parse(e.type),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new Blob(["+r.serialize(e.buffer)+"],{type:"+r.serialize(e.type)+"})"},deserialize(e,r){return new Blob([r.deserialize(e.buffer)],{type:r.deserialize(e.type)})}}),O=L;import{createPlugin as U}from"seroval";function f(e){return{detail:e.detail,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var q=U({tag:"seroval-plugins/web/CustomEvent",test(e){return typeof CustomEvent=="undefined"?!1:e instanceof CustomEvent},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(f(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(f(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(f(e))}}},serialize(e,r){return"new CustomEvent("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new CustomEvent(r.deserialize(e.type),r.deserialize(e.options))}}),H=q;import{createPlugin as M}from"seroval";var T=M({tag:"seroval-plugins/web/DOMException",test(e){return typeof DOMException=="undefined"?!1:e instanceof DOMException},parse:{sync(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}},async async(e,r){return{name:await r.parse(e.name),message:await r.parse(e.message)}},stream(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}}},serialize(e,r){return"new DOMException("+r.serialize(e.message)+","+r.serialize(e.name)+")"},deserialize(e,r){return new DOMException(r.deserialize(e.message),r.deserialize(e.name))}}),_=T;import{createPlugin as k}from"seroval";function m(e){return{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var j=k({tag:"seroval-plugins/web/Event",test(e){return typeof Event=="undefined"?!1:e instanceof Event},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(m(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(m(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(m(e))}}},serialize(e,r){return"new Event("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Event(r.deserialize(e.type),r.deserialize(e.options))}}),Y=j;import{createPlugin as V}from"seroval";var W=V({tag:"seroval-plugins/web/File",test(e){return typeof File=="undefined"?!1:e instanceof File},parse:{async async(e,r){return{name:await r.parse(e.name),options:await r.parse({type:e.type,lastModified:e.lastModified}),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new File(["+r.serialize(e.buffer)+"],"+r.serialize(e.name)+","+r.serialize(e.options)+")"},deserialize(e,r){return new File([r.deserialize(e.buffer)],r.deserialize(e.name),r.deserialize(e.options))}}),c=W;import{createPlugin as S}from"seroval";function g(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var i={},G=S({tag:"seroval-plugins/web/FormDataFactory",test(e){return e===i},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return i}}),J=S({tag:"seroval-plugins/web/FormData",extends:[c,G],test(e){return typeof FormData=="undefined"?!1:e instanceof FormData},parse:{sync(e,r){return{factory:r.parse(i),entries:r.parse(g(e))}},async async(e,r){return{factory:await r.parse(i),entries:await r.parse(g(e))}},stream(e,r){return{factory:r.parse(i),entries:r.parse(g(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.entries)+")"},deserialize(e,r){let a=new FormData,t=r.deserialize(e.entries);for(let n=0,R=t.length;n<R;n++){let b=t[n];a.append(b[0],b[1])}return a}}),K=J;import{createPlugin as Q}from"seroval";function y(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var X=Q({tag:"seroval-plugins/web/Headers",test(e){return typeof Headers=="undefined"?!1:e instanceof Headers},parse:{sync(e,r){return r.parse(y(e))},async async(e,r){return await r.parse(y(e))},stream(e,r){return r.parse(y(e))}},serialize(e,r){return"new Headers("+r.serialize(e)+")"},deserialize(e,r){return new Headers(r.deserialize(e))}}),l=X;import{createPlugin as Z}from"seroval";var $=Z({tag:"seroval-plugins/web/ImageData",test(e){return typeof ImageData=="undefined"?!1:e instanceof ImageData},parse:{sync(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}},async async(e,r){return{data:await r.parse(e.data),width:await r.parse(e.width),height:await r.parse(e.height),options:await r.parse({colorSpace:e.colorSpace})}},stream(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}}},serialize(e,r){return"new ImageData("+r.serialize(e.data)+","+r.serialize(e.width)+","+r.serialize(e.height)+","+r.serialize(e.options)+")"},deserialize(e,r){return new ImageData(r.deserialize(e.data),r.deserialize(e.width),r.deserialize(e.height),r.deserialize(e.options))}}),x=$;import{createPlugin as z,createStream as v}from"seroval";var p={},ee=z({tag:"seroval-plugins/web/ReadableStreamFactory",test(e){return e===p},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createFunction(["d"],"new ReadableStream({start:"+r.createEffectfulFunction(["c"],"d.on({next:"+r.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+r.createEffectfulFunction(["v"],"c.error(v)")+",return:"+r.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return p}});function w(e){let r=v(),a=e.getReader();async function t(){try{let n=await a.read();n.done?r.return(n.value):(r.next(n.value),await t())}catch(n){r.throw(n)}}return t().catch(()=>{}),r}var re=z({tag:"seroval/plugins/web/ReadableStream",extends:[ee],test(e){return typeof ReadableStream=="undefined"?!1:e instanceof ReadableStream},parse:{sync(e,r){return{factory:r.parse(p),stream:r.parse(v())}},async async(e,r){return{factory:await r.parse(p),stream:await r.parse(w(e))}},stream(e,r){return{factory:r.parse(p),stream:r.parse(w(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.stream)+")"},deserialize(e,r){let a=r.deserialize(e.stream);return new ReadableStream({start(t){a.on({next(n){t.enqueue(n)},throw(n){t.error(n)},return(){t.close()}})}})}}),u=re;import{createPlugin as ae}from"seroval";function P(e,r){return{body:r,cache:e.cache,credentials:e.credentials,headers:e.headers,integrity:e.integrity,keepalive:e.keepalive,method:e.method,mode:e.mode,redirect:e.redirect,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}var te=ae({tag:"seroval-plugins/web/Request",extends:[u,l],test(e){return typeof Request=="undefined"?!1:e instanceof Request},parse:{async async(e,r){return{url:await r.parse(e.url),options:await r.parse(P(e,e.body?await e.clone().arrayBuffer():null))}},stream(e,r){return{url:r.parse(e.url),options:r.parse(P(e,e.clone().body))}}},serialize(e,r){return"new Request("+r.serialize(e.url)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Request(r.deserialize(e.url),r.deserialize(e.options))}}),ne=te;import{createPlugin as oe}from"seroval";function N(e){return{headers:e.headers,status:e.status,statusText:e.statusText}}var se=oe({tag:"seroval-plugins/web/Response",extends:[u,l],test(e){return typeof Response=="undefined"?!1:e instanceof Response},parse:{async async(e,r){return{body:await r.parse(e.body?await e.clone().arrayBuffer():null),options:await r.parse(N(e))}},stream(e,r){return{body:r.parse(e.clone().body),options:r.parse(N(e))}}},serialize(e,r){return"new Response("+r.serialize(e.body)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Response(r.deserialize(e.body),r.deserialize(e.options))}}),ie=se;import{createPlugin as le}from"seroval";var pe=le({tag:"seroval-plugins/web/URL",test(e){return typeof URL=="undefined"?!1:e instanceof URL},parse:{sync(e,r){return r.parse(e.href)},async async(e,r){return await r.parse(e.href)},stream(e,r){return r.parse(e.href)}},serialize(e,r){return"new URL("+r.serialize(e)+")"},deserialize(e,r){return new URL(r.deserialize(e))}}),ue=pe;import{createPlugin as de}from"seroval";var fe=de({tag:"seroval-plugins/web/URLSearchParams",test(e){return typeof URLSearchParams=="undefined"?!1:e instanceof URLSearchParams},parse:{sync(e,r){return r.parse(e.toString())},async async(e,r){return await r.parse(e.toString())},stream(e,r){return r.parse(e.toString())}},serialize(e,r){return"new URLSearchParams("+r.serialize(e)+")"},deserialize(e,r){return new URLSearchParams(r.deserialize(e))}}),me=fe;export{C as AbortSignalPlugin,O as BlobPlugin,H as CustomEventPlugin,_ as DOMExceptionPlugin,Y as EventPlugin,c as FilePlugin,K as FormDataPlugin,l as HeadersPlugin,x as ImageDataPlugin,u as ReadableStreamPlugin,ne as RequestPlugin,ie as ResponsePlugin,ue as URLPlugin,me as URLSearchParamsPlugin};
+import{createPlugin as d}from"seroval";function h(e){e(this.reason)}function A(e){this.addEventListener("abort",h.bind(this,e),{once:!0})}function E(e){return new Promise(A.bind(e))}var o=class{constructor(){this.controller=new AbortController}},F=d({tag:"seroval-plugins/web/AbortSignalController",test(e){return e instanceof o},parse:{stream(){}},serialize(e){return"new AbortController"},deserialize(e){return new o}}),s=class{constructor(r,a){this.controller=r;this.reason=a}},D=d({extends:[F],tag:"seroval-plugins/web/AbortSignalAbort",test(e){return e instanceof s},parse:{stream(e,r){return{controller:r.parse(e.controller),reason:r.parse(e.reason)}}},serialize(e,r){return r.serialize(e.controller)+".abort("+r.serialize(e.reason)+")"},deserialize(e,r){let a=r.deserialize(e.controller),t=r.deserialize(e.reason);return a.controller.abort(t),new s(a,t)}});var I=d({tag:"seroval-plugins/web/AbortSignal",extends:[D],test(e){return typeof AbortSignal=="undefined"?!1:e instanceof AbortSignal},parse:{sync(e,r){return e.aborted?{type:1,reason:r.parse(e.reason)}:{type:0}},async async(e,r){if(e.aborted)return{type:1,reason:await r.parse(e.reason)};let a=await E(e);return{type:1,reason:await r.parse(a)}},stream(e,r){if(e.aborted)return{type:1,reason:r.parse(e.reason)};let a=new o;return r.pushPendingState(),e.addEventListener("abort",()=>{let t=r.parseWithError(new s(a,e.reason));t&&r.onParse(t),r.popPendingState()},{once:!0}),{type:2,controller:r.parse(a)}}},serialize(e,r){return e.type===0?"(new AbortController).signal":e.type===1?"AbortSignal.abort("+r.serialize(e.reason)+")":"("+r.serialize(e.controller)+").signal"},deserialize(e,r){return e.type===0?new AbortController().signal:e.type===1?AbortSignal.abort(r.deserialize(e.reason)):r.deserialize(e.controller).controller.signal}}),C=I;import{createPlugin as B}from"seroval";var L=B({tag:"seroval-plugins/web/Blob",test(e){return typeof Blob=="undefined"?!1:e instanceof Blob},parse:{async async(e,r){return{type:await r.parse(e.type),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new Blob(["+r.serialize(e.buffer)+"],{type:"+r.serialize(e.type)+"})"},deserialize(e,r){return new Blob([r.deserialize(e.buffer)],{type:r.deserialize(e.type)})}}),O=L;import{createPlugin as U}from"seroval";function f(e){return{detail:e.detail,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var q=U({tag:"seroval-plugins/web/CustomEvent",test(e){return typeof CustomEvent=="undefined"?!1:e instanceof CustomEvent},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(f(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(f(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(f(e))}}},serialize(e,r){return"new CustomEvent("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new CustomEvent(r.deserialize(e.type),r.deserialize(e.options))}}),H=q;import{createPlugin as M}from"seroval";var T=M({tag:"seroval-plugins/web/DOMException",test(e){return typeof DOMException=="undefined"?!1:e instanceof DOMException},parse:{sync(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}},async async(e,r){return{name:await r.parse(e.name),message:await r.parse(e.message)}},stream(e,r){return{name:r.parse(e.name),message:r.parse(e.message)}}},serialize(e,r){return"new DOMException("+r.serialize(e.message)+","+r.serialize(e.name)+")"},deserialize(e,r){return new DOMException(r.deserialize(e.message),r.deserialize(e.name))}}),_=T;import{createPlugin as k}from"seroval";function m(e){return{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}}var j=k({tag:"seroval-plugins/web/Event",test(e){return typeof Event=="undefined"?!1:e instanceof Event},parse:{sync(e,r){return{type:r.parse(e.type),options:r.parse(m(e))}},async async(e,r){return{type:await r.parse(e.type),options:await r.parse(m(e))}},stream(e,r){return{type:r.parse(e.type),options:r.parse(m(e))}}},serialize(e,r){return"new Event("+r.serialize(e.type)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Event(r.deserialize(e.type),r.deserialize(e.options))}}),Y=j;import{createPlugin as V}from"seroval";var W=V({tag:"seroval-plugins/web/File",test(e){return typeof File=="undefined"?!1:e instanceof File},parse:{async async(e,r){return{name:await r.parse(e.name),options:await r.parse({type:e.type,lastModified:e.lastModified}),buffer:await r.parse(await e.arrayBuffer())}}},serialize(e,r){return"new File(["+r.serialize(e.buffer)+"],"+r.serialize(e.name)+","+r.serialize(e.options)+")"},deserialize(e,r){return new File([r.deserialize(e.buffer)],r.deserialize(e.name),r.deserialize(e.options))}}),c=W;import{createPlugin as S}from"seroval";function g(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var i={},G=S({tag:"seroval-plugins/web/FormDataFactory",test(e){return e===i},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return i}}),J=S({tag:"seroval-plugins/web/FormData",extends:[c,G],test(e){return typeof FormData=="undefined"?!1:e instanceof FormData},parse:{sync(e,r){return{factory:r.parse(i),entries:r.parse(g(e))}},async async(e,r){return{factory:await r.parse(i),entries:await r.parse(g(e))}},stream(e,r){return{factory:r.parse(i),entries:r.parse(g(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.entries)+")"},deserialize(e,r){let a=new FormData,t=r.deserialize(e.entries);for(let n=0,R=t.length;n<R;n++){let b=t[n];a.append(b[0],b[1])}return a}}),K=J;import{createPlugin as Q}from"seroval";function y(e){let r=[];return e.forEach((a,t)=>{r.push([t,a])}),r}var X=Q({tag:"seroval-plugins/web/Headers",test(e){return typeof Headers=="undefined"?!1:e instanceof Headers},parse:{sync(e,r){return r.parse(y(e))},async async(e,r){return await r.parse(y(e))},stream(e,r){return r.parse(y(e))}},serialize(e,r){return"new Headers("+r.serialize(e)+")"},deserialize(e,r){return new Headers(r.deserialize(e))}}),l=X;import{createPlugin as Z}from"seroval";var $=Z({tag:"seroval-plugins/web/ImageData",test(e){return typeof ImageData=="undefined"?!1:e instanceof ImageData},parse:{sync(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}},async async(e,r){return{data:await r.parse(e.data),width:await r.parse(e.width),height:await r.parse(e.height),options:await r.parse({colorSpace:e.colorSpace})}},stream(e,r){return{data:r.parse(e.data),width:r.parse(e.width),height:r.parse(e.height),options:r.parse({colorSpace:e.colorSpace})}}},serialize(e,r){return"new ImageData("+r.serialize(e.data)+","+r.serialize(e.width)+","+r.serialize(e.height)+","+r.serialize(e.options)+")"},deserialize(e,r){return new ImageData(r.deserialize(e.data),r.deserialize(e.width),r.deserialize(e.height),r.deserialize(e.options))}}),x=$;import{createPlugin as z,createStream as v}from"seroval";var p={},ee=z({tag:"seroval-plugins/web/ReadableStreamFactory",test(e){return e===p},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(e,r){return r.createFunction(["d"],"new ReadableStream({start:"+r.createEffectfulFunction(["c"],"d.on({next:"+r.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+r.createEffectfulFunction(["v"],"c.error(v)")+",return:"+r.createEffectfulFunction([],"try{c.close()}catch{}")+"})")+"})")},deserialize(){return p}});function w(e){let r=v(),a=e.getReader();async function t(){try{let n=await a.read();n.done?r.return(n.value):(r.next(n.value),await t())}catch(n){r.throw(n)}}return t().catch(()=>{}),r}var re=z({tag:"seroval/plugins/web/ReadableStream",extends:[ee],test(e){return typeof ReadableStream=="undefined"?!1:e instanceof ReadableStream},parse:{sync(e,r){return{factory:r.parse(p),stream:r.parse(v())}},async async(e,r){return{factory:await r.parse(p),stream:await r.parse(w(e))}},stream(e,r){return{factory:r.parse(p),stream:r.parse(w(e))}}},serialize(e,r){return"("+r.serialize(e.factory)+")("+r.serialize(e.stream)+")"},deserialize(e,r){let a=r.deserialize(e.stream);return new ReadableStream({start(t){a.on({next(n){t.enqueue(n)},throw(n){t.error(n)},return(){try{t.close()}catch{}}})}})}}),u=re;import{createPlugin as ae}from"seroval";function P(e,r){return{body:r,cache:e.cache,credentials:e.credentials,headers:e.headers,integrity:e.integrity,keepalive:e.keepalive,method:e.method,mode:e.mode,redirect:e.redirect,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}var te=ae({tag:"seroval-plugins/web/Request",extends:[u,l],test(e){return typeof Request=="undefined"?!1:e instanceof Request},parse:{async async(e,r){return{url:await r.parse(e.url),options:await r.parse(P(e,e.body?await e.clone().arrayBuffer():null))}},stream(e,r){return{url:r.parse(e.url),options:r.parse(P(e,e.clone().body))}}},serialize(e,r){return"new Request("+r.serialize(e.url)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Request(r.deserialize(e.url),r.deserialize(e.options))}}),ne=te;import{createPlugin as oe}from"seroval";function N(e){return{headers:e.headers,status:e.status,statusText:e.statusText}}var se=oe({tag:"seroval-plugins/web/Response",extends:[u,l],test(e){return typeof Response=="undefined"?!1:e instanceof Response},parse:{async async(e,r){return{body:await r.parse(e.body?await e.clone().arrayBuffer():null),options:await r.parse(N(e))}},stream(e,r){return{body:r.parse(e.clone().body),options:r.parse(N(e))}}},serialize(e,r){return"new Response("+r.serialize(e.body)+","+r.serialize(e.options)+")"},deserialize(e,r){return new Response(r.deserialize(e.body),r.deserialize(e.options))}}),ie=se;import{createPlugin as le}from"seroval";var pe=le({tag:"seroval-plugins/web/URL",test(e){return typeof URL=="undefined"?!1:e instanceof URL},parse:{sync(e,r){return r.parse(e.href)},async async(e,r){return await r.parse(e.href)},stream(e,r){return r.parse(e.href)}},serialize(e,r){return"new URL("+r.serialize(e)+")"},deserialize(e,r){return new URL(r.deserialize(e))}}),ue=pe;import{createPlugin as de}from"seroval";var fe=de({tag:"seroval-plugins/web/URLSearchParams",test(e){return typeof URLSearchParams=="undefined"?!1:e instanceof URLSearchParams},parse:{sync(e,r){return r.parse(e.toString())},async async(e,r){return await r.parse(e.toString())},stream(e,r){return r.parse(e.toString())}},serialize(e,r){return"new URLSearchParams("+r.serialize(e)+")"},deserialize(e,r){return new URLSearchParams(r.deserialize(e))}}),me=fe;export{C as AbortSignalPlugin,O as BlobPlugin,H as CustomEventPlugin,_ as DOMExceptionPlugin,Y as EventPlugin,c as FilePlugin,K as FormDataPlugin,l as HeadersPlugin,x as ImageDataPlugin,u as ReadableStreamPlugin,ne as RequestPlugin,ie as ResponsePlugin,ue as URLPlugin,me as URLSearchParamsPlugin};
diff --git a/web/readable-stream.ts b/web/readable-stream.ts
index ef2eae3caf2c9c0f84a38655906ebe7016857399..f370aeef767101a40cfa822fa4058a68ccd87d4d 100644
--- a/web/readable-stream.ts
+++ b/web/readable-stream.ts
@@ -33,7 +33,7 @@ const ReadableStreamFactoryPlugin = /* @__PURE__ */ createPlugin<
             ',throw:' +
             ctx.createEffectfulFunction(['v'], 'c.error(v)') +
             ',return:' +
-            ctx.createEffectfulFunction([], 'c.close()') +
+            ctx.createEffectfulFunction([], 'try{c.close()}catch{}') +
             '})',
         ) +
         '})',
@@ -128,7 +128,9 @@ const ReadableStreamPlugin = /* @__PURE__ */ createPlugin<
             controller.error(value);
           },
           return() {
-            controller.close();
+            try{
+              controller.close();
+            } catch {}
           },
         });
       },
